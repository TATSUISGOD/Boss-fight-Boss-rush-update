<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚¿ãƒƒãƒ—RPG å®Œå…¨ç‰ˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{background:#111;color:#fff;font-family:sans-serif;text-align:center;margin:0;padding:20px}
button{font-size:18px;padding:14px 26px;margin:6px}
#tapBtn{font-size:28px;padding:32px 64px;margin-top:20px}
.hidden{display:none!important;pointer-events:none!important}
.boss{font-size:80px}
.player{font-size:60px;margin:10px}
.hp-bar{width:80%;height:20px;background:#444;margin:10px auto;border-radius:10px;overflow:hidden}
.hp{height:100%;background:red;transition:width .1s}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.9);display:flex;justify-content:center;align-items:center;z-index:999;font-size:26px;text-align:center;padding:20px}
.rare{color:#4af}.sr{color:#c6f}.hr{color:#fa4}.ur{color:gold}
.lr{background:linear-gradient(45deg,red,orange,yellow,green,cyan,blue,purple);
-webkit-background-clip:text;color:transparent;font-weight:bold}
.timer{font-size:22px;color:#0f0}
</style>
</head>
<body>

<h1>ğŸ”¥ ã‚¿ãƒƒãƒ—RPG ğŸ”¥</h1>

<p>ğŸ’° ã‚³ã‚¤ãƒ³: <span id="coin">0</span></p>
<p>ğŸ’ ãƒ€ã‚¤ãƒ¤: <span id="dia">0</span></p>
<p>âš” æ”»æ’ƒåŠ›åˆè¨ˆ: +<span id="atk">0</span></p>

<div class="player" id="player">ğŸ™‚</div>

<button onclick="drawGacha()">ğŸ° ã‚¬ãƒãƒ£ï¼ˆ100ã‚³ã‚¤ãƒ³ï¼‰</button>
<button onclick="drawDiaGacha()">ğŸ’ ä¸Šä½ã‚¬ãƒãƒ£</button>
<button onclick="exchangeDia()">ğŸ’°1000 â†’ ğŸ’1</button>
<button onclick="showDex()">ğŸ“– å›³é‘‘</button>

<hr>

<!-- â˜… ã“ã“ãŒè¿½åŠ  -->
<button onclick="startBossRush()">âš” ãƒœã‚¹ãƒ©ãƒƒã‚·ãƒ¥ï¼ˆ60ç§’ï¼‰</button>
<p id="rushTimer" class="timer hidden"></p>

<div id="select">
<h2>ãƒœã‚¹é¸æŠ</h2>
<button onclick="startBattle('ã‚¹ãƒ©ã‚¤ãƒ ',100,'ğŸŸ¢',10)">ã‚¹ãƒ©ã‚¤ãƒ </button>
<button onclick="startBattle('ã‚ªãƒ¼ã‚¯',300,'ğŸ‘¹',20)">ã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('ãƒ‰ãƒ©ã‚´ãƒ³',500,'ğŸ‰',50)">ãƒ‰ãƒ©ã‚´ãƒ³</button>
<button onclick="startBattle('ã‚´ãƒ¼ãƒ¬ãƒ ',1200,'ğŸ—¿',120)">ã‚´ãƒ¼ãƒ¬ãƒ </button>
<button onclick="startBattle('ãƒ‡ãƒ¼ãƒ¢ãƒ³',2500,'ğŸ˜ˆ',250)">ãƒ‡ãƒ¼ãƒ¢ãƒ³</button>
<button onclick="startBattle('ç¥ç«œ',5000,'ğŸ²âœ¨',500)">ç¥ç«œ</button>
</div>

<div id="game" class="hidden">
<h2 id="bossName"></h2>
<div class="boss" id="bossIcon"></div>
<div class="hp-bar"><div class="hp" id="hp"></div></div>
<p>HP: <span id="hpText"></span></p>
<button id="tapBtn">ã‚¿ãƒƒãƒ—ï¼</button>
</div>

<div id="overlay" class="overlay hidden"></div>

<script>
let coin=+localStorage.getItem("coin")||0;
let dia=+localStorage.getItem("dia")||0;
let atkBonus=+localStorage.getItem("atkBonus")||0;
let dex=JSON.parse(localStorage.getItem("dex")||"{}");

let bossHp=0,maxHp=0,reward=0,startTime=0,tapCount=0;
let bossRush=false,rushTime=60,rushCount=0,rushInterval=null;

const coinEl=document.getElementById("coin");
const atkEl=document.getElementById("atk");
const diaEl=document.getElementById("dia");
const overlay=document.getElementById("overlay");
const timerEl=document.getElementById("rushTimer");

coinEl.textContent=coin;
atkEl.textContent=atkBonus.toFixed(1);
diaEl.textContent=dia;

const rushBosses=[
["ç‹‚åŒ–ã‚¹ãƒ©ã‚¤ãƒ ",800,"ğŸŸ¢ğŸ”¥"],
["è£…ç”²ã‚ªãƒ¼ã‚¯",1500,"ğŸ‘¹ğŸ›¡ï¸"],
["ç´…è“®ç«œ",3000,"ğŸ‰ğŸ”¥"],
["å¤ä»£ã‚´ãƒ¼ãƒ¬ãƒ ",6000,"ğŸ—¿âœ¨"],
["é­”ç‹ãƒ‡ãƒ¼ãƒ¢ãƒ³",10000,"ğŸ˜ˆğŸ‘‘"],
["æ··æ²Œç«œ",15000,"ğŸ²ğŸ’¥"],
["è™šç„¡ã®é¨å£«",22000,"âš”ï¸ğŸ–¤"],
["æ˜Ÿå–°ã„ç£",30000,"ğŸŒŒğŸ‘¾"],
["æ™‚ç©ºç«œ",45000,"â³ğŸ²"],
["çµ‚ç„‰ã®ç¥",70000,"ğŸ’€âœ¨"]
];

function startBossRush(){
bossRush=true;
rushTime=60;
rushCount=0;
timerEl.classList.remove("hidden");
timerEl.textContent="â± 60";
document.getElementById("select").classList.add("hidden");
document.getElementById("game").classList.remove("hidden");
nextRushBoss();

rushInterval=setInterval(()=>{
rushTime--;
timerEl.textContent="â± "+rushTime;
if(rushTime<=0)endBossRush();
},1000);
}

function nextRushBoss(){
let b=rushBosses[Math.min(rushCount,rushBosses.length-1)];
startBattle(b[0],b[1],b[2],0);
}

function endBossRush(){
clearInterval(rushInterval);
bossRush=false;
timerEl.classList.add("hidden");
document.getElementById("game").classList.add("hidden");
document.getElementById("select").classList.remove("hidden");

let coinGain=rushCount*200;
let diaGain=Math.floor(rushCount/5);
if(rushCount>=10)diaGain+=3;

coin+=coinGain;
dia+=diaGain;
save();

showOverlay(`âš” ãƒœã‚¹ãƒ©ãƒƒã‚·ãƒ¥çµ‚äº†ï¼<br>
æ’ƒç ´æ•°ï¼š${rushCount}<br>
ğŸ’° +${coinGain}<br>
ğŸ’ +${diaGain}`);
}

function startBattle(n,h,i,r){
tapCount=0;bossHp=maxHp=h;reward=r;startTime=Date.now();
bossName.textContent=n;bossIcon.textContent=i;updateHp();
}

function updateHp(){
hpText.textContent=Math.ceil(bossHp);
hp.style.width=(bossHp/maxHp*100)+"%";
}

tapBtn.onclick=()=>{
tapCount++;
let dmg=1+atkBonus+(tapCount%10===0?1:0);
bossHp=Math.max(0,bossHp-dmg);updateHp();
if(bossHp===0){
if(bossRush){
rushCount++;
nextRushBoss();
}else{
coin+=reward;
save();
document.getElementById("game").classList.add("hidden");
document.getElementById("select").classList.remove("hidden");
showOverlay("ğŸ‰ æ’ƒç ´ï¼");
}}
};

function drawGacha(){if(coin<100)return showOverlay("ã‚³ã‚¤ãƒ³ä¸è¶³");coin-=100;atkBonus+=0.1;save()}
function drawDiaGacha(){if(dia<1)return showOverlay("ãƒ€ã‚¤ãƒ¤ä¸è¶³");dia--;atkBonus+=1;save()}
function exchangeDia(){if(coin<1000)return showOverlay("ã‚³ã‚¤ãƒ³ä¸è¶³");coin-=1000;dia++;save()}
function showDex(){let h="<h2>ğŸ“– å›³é‘‘</h2>";for(let k in dex)h+=`<div>${k}</div>`;showOverlay(h)}

function showOverlay(h){overlay.innerHTML=h+"<br><small>(ã‚¿ãƒƒãƒ—ã§é–‰ã˜ã‚‹)</small>";overlay.classList.remove("hidden")}
overlay.onclick=()=>overlay.classList.add("hidden");

function save(){
localStorage.setItem("coin",coin);
localStorage.setItem("dia",dia);
localStorage.setItem("atkBonus",atkBonus);
coinEl.textContent=coin;
diaEl.textContent=dia;
atkEl.textContent=atkBonus.toFixed(1);
}
</script>
</body>
</html>
